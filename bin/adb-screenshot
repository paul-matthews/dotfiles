#!/bin/bash

DEVICE_STRING=""
# Get options
while getopts "s:" opt; do
    case $opt in
        s) DEVICE_STRING="-s $OPTARG" ;;
    esac
done

ARG1=${@:$OPTIND:1}
TS=`date +%s`
FMT="${ARG1:-screenshot}-$TS.png"

adb $DEVICE_STRING shell screencap -p /sdcard/screen.png
adb $DEVICE_STRING pull /sdcard/screen.png
adb $DEVICE_STRING shell rm /sdcard/screen.png

mv screen.png "$FMT"
echo "Screenshot generated: $FMT"
